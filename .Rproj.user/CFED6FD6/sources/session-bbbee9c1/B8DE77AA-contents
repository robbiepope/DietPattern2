library(dplyr)
# TESTING
rm(list=ls())
ffq1 <- read.csv("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/!Documentation/FFQ_Data_Processing_Protocol/6_GramsDayFood/final/ffq1_processed_foods_grams_per_day.csv")
ffq2 <- read.csv("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/!Documentation/FFQ_Data_Processing_Protocol/6_GramsDayFood/final/ffq2_processed_foods_grams_per_day.csv")
#ffq3 <- read.csv("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/!Documentation/FFQ_Data_Processing_Protocol/6_GramsDayFood/final/ffq3_processed_foods_grams_per_day.csv")
#ffq3b <- read.csv("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/!Documentation/FFQ_Data_Processing_Protocol/6_GramsDayFood/final/ffq3b_processed_foods_grams_per_day.csv")
#ffq3c <- read.csv("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/!Documentation/FFQ_Data_Processing_Protocol/6_GramsDayFood/final/ffq3c_processed_foods_grams_per_day.csv")
#ffq3d <- read.csv("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/!Documentation/FFQ_Data_Processing_Protocol/6_GramsDayFood/final/ffq3d_processed_foods_grams_per_day.csv")
#ffq4 <- read.csv("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/!Documentation/FFQ_Data_Processing_Protocol/6_GramsDayFood/final/ffq4_processed_foods_grams_per_day.csv")
source("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/1_LEAP_Github/RLibrary/DietPattern/get_food_bev_groups.R")
source("/Users/k23108931/Library/CloudStorage/OneDrive-King\'sCollegeLondon/4_PhD_Analysis/1_FFq_Data/1_LEAP_Github/RLibrary/DietPattern/calculate_pdi.R")

testf1 <- get_food_bev_groups(ffq1, stnd_groups = 'Y')
testf2 <- get_food_bev_groups(ffq2, stnd_groups = 'Y')


# Assign food groups into healthy/less healthy/animal categories
long_df <- assign_health_groups(testf2)

# Assign percentile of intake (rank within each food group)
long_df <- assign_percentile(long_df, perc = 0.2)

# Assign scores for PDI, hPDI, uPDI
long_df <- assign_pdi_scores(long_df)

#  Sum scores per individual to get total indices
df_scores <- sum_pdi_scores(long_df)

mean(df_scores$hPDI)

test2 <- long_df %>% 
  filter(UniqueKey == 4960)

test3 <- long_df %>%
  filter(FoodGroup == 'nuts_seeds')



#line1 <- ffq1[1, ]
#line2 <- ffq2[1, ]


#group1 <- line1 %>% 
#  select(c('BUTTER'))
#group2 <- line2 %>% 
#  select(c('BUTTER', 'REDUCED_FAT_BUTTER'))

long <- assign_health_groups(testf1)
perc_long <- assign_percentile(long)

test <- perc_long %>% 
  filter(FoodGroup == "legumes")


pdi1 <- twinsuk_pdi(ffq1)
pdi2 <- twinsuk_pdi(ffq2)
pdi3 <- twinsuk_pdi(ffq3)
pdi3b <- twinsuk_pdi(ffq3b)
pdi3c <- twinsuk_pdi(ffq3c)
pdi3d <- twinsuk_pdi(ffq3d)
pdi4 <- twinsuk_pdi(ffq4)

